# gRPC Workflow Quick Reference

Quick visualization guide for both gRPC use cases.

---

## ğŸ“– UC-014: GetManga (Get by ID)

```
     CLIENT              gRPC SERVER           REPOSITORY          DATABASE
       â”‚                      â”‚                     â”‚                  â”‚
       â”‚  GetManga(id=1)      â”‚                     â”‚                  â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚                  â”‚
       â”‚   (HTTP/2 + Protobuf)â”‚                     â”‚                  â”‚
       â”‚                      â”‚  GetByID(ctx, 1)    â”‚                  â”‚
       â”‚                      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
       â”‚                      â”‚                     â”‚ SELECT * FROM    â”‚
       â”‚                      â”‚                     â”‚  mangas         â”‚
       â”‚                      â”‚                     â”‚  WHERE id = 1    â”‚
       â”‚                      â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                      â”‚                     â”‚  Manga Record    â”‚
       â”‚                      â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                      â”‚  *models.Manga      â”‚                  â”‚
       â”‚                      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚
       â”‚                      â”‚ modelToProto()      â”‚                  â”‚
       â”‚  GetMangaResponse    â”‚                     â”‚                  â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚                  â”‚
       â”‚   (Protobuf Binary)  â”‚                     â”‚                  â”‚
       â”‚                      â”‚                     â”‚                  â”‚
    Display                                                          
    manga                                                            
    details                                                          

Time: ~10-20ms
```

---

## ğŸ” UC-015: SearchManga (Search with pagination)

```
     CLIENT              gRPC SERVER           REPOSITORY          DATABASE
       â”‚                      â”‚                     â”‚                  â”‚
       â”‚  SearchManga         â”‚                     â”‚                  â”‚
       â”‚  query="one piece"   â”‚                     â”‚                  â”‚
       â”‚  limit=10, offset=0  â”‚                     â”‚                  â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚                  â”‚
       â”‚   (HTTP/2 + Protobuf)â”‚                     â”‚                  â”‚
       â”‚                      â”‚  SearchByTitle      â”‚                  â”‚
       â”‚                      â”‚  (ctx, "one piece") â”‚                  â”‚
       â”‚                      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
       â”‚                      â”‚                     â”‚ SELECT * WHERE   â”‚
       â”‚                      â”‚                     â”‚  title ILIKE     â”‚
       â”‚                      â”‚                     â”‚  '%one%' AND     â”‚
       â”‚                      â”‚                     â”‚  '%piece%'       â”‚
       â”‚                      â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                      â”‚                     â”‚  []Manga (all)   â”‚
       â”‚                      â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                      â”‚  []models.Manga     â”‚                  â”‚
       â”‚                      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚
       â”‚                      â”‚                     â”‚                  â”‚
       â”‚                      â”‚ Apply Pagination    â”‚                  â”‚
       â”‚                      â”‚ (in-memory)         â”‚                  â”‚
       â”‚                      â”‚ all[0:10]          â”‚                  â”‚
       â”‚                      â”‚                     â”‚                  â”‚
       â”‚                      â”‚ Convert to Protobuf â”‚                  â”‚
       â”‚                      â”‚ modelToProto()      â”‚                  â”‚
       â”‚                      â”‚                     â”‚                  â”‚
       â”‚  SearchResponse      â”‚                     â”‚                  â”‚
       â”‚  mangas: [...]       â”‚                     â”‚                  â”‚
       â”‚  total_count: 3      â”‚                     â”‚                  â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚                  â”‚
       â”‚   (Protobuf Binary)  â”‚                     â”‚                  â”‚
       â”‚                      â”‚                     â”‚                  â”‚
    Display                                                          
    search                                                           
    results                                                          

Time: ~50-200ms
```

---

## ğŸ”„ HTTP/2 Layer (Both Use Cases)

```
APPLICATION:    [Your Go Code] â”€â”€> GetManga() / SearchManga()
                       â”‚
RPC FRAMEWORK:  [gRPC] â”€â”€> Handles method routing
                       â”‚
SERIALIZATION:  [Protobuf] â”€â”€> Binary encoding/decoding
                       â”‚
TRANSPORT:      [HTTP/2] â”€â”€> HEADERS + DATA frames âœ“
                       â”‚
NETWORK:        [TCP] â”€â”€> Port 8083
                       â”‚
                  [IP Network]
```

---

## ğŸ“Š Data Transformation Flow

### UC-014: GetManga

```
1. Client Request
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ GetMangaRequest         â”‚
   â”‚   manga_id: 1           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼ Protobuf Encode
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Binary: [08 01]         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼ HTTP/2 Transport
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ HEADERS + DATA frames   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼ Server Decode
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ req.GetMangaId() â†’ 1    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼ Database Query
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ SELECT * FROM mangas    â”‚
   â”‚ WHERE id = 1            â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼ GORM Mapping
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ models.Manga {          â”‚
   â”‚   ID: 1                 â”‚
   â”‚   Title: "JoJo's..."    â”‚
   â”‚   Genres: [...]         â”‚
   â”‚ }                       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼ modelToProto()
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ pb.Manga {              â”‚
   â”‚   id: 1                 â”‚
   â”‚   title: "JoJo's..."    â”‚
   â”‚   genres: []string      â”‚
   â”‚ }                       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼ Protobuf Encode
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Binary: [full manga]    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼ HTTP/2 Response
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ HEADERS + DATA frames   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼ Client Decode
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ resp.Manga              â”‚
   â”‚ Display to user         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### UC-015: SearchManga

```
1. Client Request
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ SearchRequest           â”‚
   â”‚   query: "one piece"    â”‚
   â”‚   limit: 10             â”‚
   â”‚   offset: 0             â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼ Database Search
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Tokenize: ["one","piece"]â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼ Build Query
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ WHERE title ILIKE '%one%'â”‚
   â”‚   AND title ILIKE '%piece%'â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼ Query Result
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ []models.Manga (3 items)â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼ Pagination
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ all[0:3] â†’ all 3 items  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼ Convert Each
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ []pb.Manga {            â”‚
   â”‚   [0] {id:5, ...}       â”‚
   â”‚   [1] {id:12, ...}      â”‚
   â”‚   [2] {id:23, ...}      â”‚
   â”‚ }                       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼ Build Response
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ SearchResponse {        â”‚
   â”‚   mangas: []pb.Manga    â”‚
   â”‚   total_count: 3        â”‚
   â”‚ }                       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼ Return to Client
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Display search results  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Key Differences

| Aspect | UC-014 | UC-015 |
|--------|--------|--------|
| **Input** | Single ID | Query string + pagination |
| **Query Type** | Primary key lookup | Text search (ILIKE) |
| **Processing** | Direct fetch | Tokenize + filter |
| **Result** | Single object | Array of objects |
| **Pagination** | N/A | In-memory slicing |
| **Latency** | Fast (10-20ms) | Slower (50-200ms) |
| **Complexity** | O(1) | O(n) |

---

## ğŸ“š Full Details

See `GRPC-WORKFLOW-VISUALIZATION.md` for:
- Complete step-by-step breakdowns
- HTTP/2 frame details
- SQL query examples
- Code snippets at each layer
- Performance characteristics

---

**Quick Test Commands:**

```bash
# UC-014: GetManga
go run cmd/grpc-client/main.go -action=get -id=1

# UC-015: SearchManga
go run cmd/grpc-client/main.go -action=search -query="one piece" -limit=10
```
